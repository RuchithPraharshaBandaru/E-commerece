<body class="bg-gray-100">
  <div class="w-full min-h-screen mx-auto bg-white shadow-md rounded-lg p-6">
    <!-- Header -->
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-xl font-bold">Customers</h1>

    </div>

    <!-- Search Bar -->
    <div class="relative mb-4">
      <input type="text" id="search" placeholder="Search Customers"
        class="w-full border border-gray-300 rounded-lg py-2 px-4 focus:outline-none focus:ring focus:ring-green-300"
        onkeyup="filterCustomers()">
    </div>

    <!-- Table -->
    <div class="overflow-x-auto">
      <table class="w-full border-collapse bg-white text-left text-sm text-gray-700">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-4 py-2">Photo</th>
            <th class="px-4 py-2">Product Name</th>
            <th class="px-4 py-2">Category</th>
            <th class="px-4 py-2">Quantity</th>
            <th class="px-4 py-2">Price</th>
            <th class="px-4 py-2">Stock</th>
            <th class="px-4 py-2">Actions</th>
          </tr>
        </thead>
        <tbody id="customer-table">
          <!-- Rows will be injected dynamically -->
        </tbody>
      </table>
    </div>


  </div>

  <script>


    async function getProducts() {
      const reponse = await fetch("http://localhost:8000/api/v1/admin/products/details", { method: "GET" });

      const data = await reponse.json();
      console.log(data)
      displayCustomers(data.products)
    }

    function displayCustomers(products) {

      const table = document.getElementById("customer-table");
      table.innerHTML = "";

      products.forEach((product, index) => {
        const row = `<tr class='border-t hover:bg-gray-50'>
          <td class='px-4 py-2'><img src="${product.image}" class="rounded-full w-10 h-10" alt="Avatar"></td>
          <td class='px-4 py-2'>${product.title}</td>
          <td class='px-4 py-2'>${product.category}</td>
          <td class='px-4 py-2'>${product.quantity}</td>
          <td class='px-4 py-2'>${product.price}</td>
          <td class='px-4 py-2'>${product.stock.toString()}</td>
          <td class='px-4 py-2'>
             <button class="px-2 py-1 bg-blue-500 text-white rounded-md text-xs" onclick="viewCustomer('${product._id}')">View</button>
            
            <button class="px-2 py-1 bg-red-500 text-white rounded-md text-xs" onclick="deleteCustomer('${product._id}')">Delete</button>
          </td>
        </tr>`;
        table.innerHTML += row;
      });

    }

  async  function deleteCustomer(id) {
      if (confirm("Are you sure you want to delete this customer?")) {
        try {
          await fetch(`http://localhost:8000/api/v1/admin/product/${id}`,{method:"DELETE"})
          getProducts();
        } catch (error) {
          alert("Failed to delete product")
        }
      }
    }

    getProducts()
  </script>
</body>

</html>